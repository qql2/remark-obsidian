"use strict";var N=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var $=(o,t)=>{for(var i in t)N(o,i,{get:t[i],enumerable:!0})},B=(o,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of S(t))!T.call(o,e)&&e!==i&&N(o,e,{get:()=>t[e],enumerable:!(r=A(t,e))||r.enumerable});return o};var C=o=>B(N({},"__esModule",{value:!0}),o);var L={};$(L,{default:()=>R,remarkObsidian:()=>w});module.exports=C(L);var k=require("unist-util-visit"),w=function(){return o=>{(0,k.visit)(o,"image",(t,i,r)=>{if(!r||i===null)return;let e={type:"obsidianEmbed",value:t.alt?`![${t.alt}](${t.url})`:`![](${t.url})`,data:{embedType:"image",target:t.url,alt:t.alt},position:t.position};r.children[i]=e}),(0,k.visit)(o,"text",(t,i,r)=>{if(!r||i===null)return;let e=t.value,P=/!\[\[([^\]]+)\]\]/g,p=[],m;for(;(m=P.exec(e))!==null;)p.push({match:m,start:m.index,end:m.index+m[0].length});if(p.length===0)return;p.sort((n,s)=>s.start-n.start);let f=[],l=e.length,c=t.position,b=(n,s)=>{if(!n||!n.start)return{line:1,column:1,offset:0};let a=n.start.offset||0,h=n.start.line||1,y=n.start.column||1,u=e.slice(0,s),d=(u.match(/\n/g)||[]).length,g=u.lastIndexOf(`
`),x=h+d,E=g===-1?y+s:s-g;return{line:x,column:E,offset:a+s}};for(let{match:n,start:s,end:a}of p){if(a<l){let v=e.slice(a,l);if(v){let O=b(c,a),I=b(c,l);f.unshift({type:"text",value:v,position:{start:O,end:I}})}}let h=b(c,s),y=b(c,a),u=n[1],d=u.indexOf("|"),g=d===-1?u:u.slice(0,d),x=d===-1?void 0:u.slice(d+1),E={type:"obsidianEmbed",value:n[0],data:{embedType:"wikilink",target:g,...x&&{alt:x}},position:{start:h,end:y}};f.unshift(E),l=s}if(l>0){let n=e.slice(0,l);if(n){let s=c?c.start:{line:1,column:1,offset:0},a=b(c,l);f.unshift({type:"text",value:n,position:{start:s,end:a}})}}f.length>0&&r.children.splice(i,1,...f)})}},R=w;
